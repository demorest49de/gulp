const pageSettings=()=>({currentPage:"",endPage:"",currentPageStr:"currentPage"});let{currentPage:currentPage,currentPageStr:currentPageStr,endPage:endPage}={currentPage:"",endPage:"",currentPageStr:"currentPage"};const setStorage=(e,t)=>(localStorage.setItem(e,`${t}`),t),getPageFromStorage=()=>{currentPage=localStorage.getItem(currentPageStr),currentPage=currentPage&&Number.isInteger(+currentPage)?currentPage:setStorage(currentPageStr,"1")};export const loadItemsHandler=e=>{const t=(e,t)=>(e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e);(async e=>{const t=await fetch(`https://gorest.co.in/public-api/posts?page=${currentPage}&per_page=12`);e(await t.json())})((a=>{endPage=a.meta.pagination.total,setStorage("endPage",endPage);const r=a.data.map(((e,a)=>{const r=(()=>{const e={day:"numeric",month:"long",year:"numeric"},t=(new Date).toLocaleDateString("ru-RU",e).split(" ").slice(0,-1),[a,r,n]=t;return`${a} ${r} ${n}, `})(),n=(()=>{const e={hour:"2-digit",minute:"2-digit"};return(new Date).toLocaleTimeString("ru-RU",e).split(" ").toString()})(),g=document.createElement("article");return g.classList.add("blog__article","article"),g.innerHTML=`\n                <a class="article__link" href="article.html?id=${e.id}">\n                    <picture class="article__image">\n                        <source srcset="./img/blog/${a}.avif" type="image/avif">\n                        <source srcset="./img/blog/${a}.webp" type="image/webp">\n                        <img loading="lazy" src="./img/blog/${a}.png" alt="${e.title}" width="140" height="140">\n                    </picture>\n                    <div class="article__block">\n                        <h2 class="article__subtitle">\n                            <span class="article__text">\n                                ${e.title}\n                            </span>\n                        </h2>\n                        <div class="article__subblock">\n                            <div class="article__datetime">\n                                <span class="article__date">${r}</span>\n                                <span class="article__time">${n}</span>\n                            </div>\n                        \n                            <div class="article__views-comments">\n                                <span class="article__text-block">\n                                <svg class="article__icon" xmlns="http://www.w3.org/2000/svg">\n                                    <use href="./img/blog/views-chat.svg#views"></use>\n                                </svg>\n                                    ${t(1,3)}.${t(0,9)}K</span>\n                                <span class="article__text-block">\n                                <svg class="article__icon" xmlns="http://www.w3.org/2000/svg">\n                                    <use href="./img/blog/views-chat.svg#chat"></use>\n                                </svg>\n                                    ${t(13,200)}</span>\n                            </div>\n                        </div>\n                    </div>\n                </a>\n        `,g}));for(;e.blogItems.blogList.childElementCount>0;)e.blogItems.blogList.childNodes[0].remove();e.blogItems.blogList.append(...r)}))};const setPage=e=>{currentPage=localStorage.getItem(currentPageStr),currentPage=currentPage&&Number.isInteger(+currentPage)?currentPage:setStorage(currentPageStr,"1");[...e.blogItems.pageElems.pageList.querySelectorAll(".pagination__item")].forEach((e=>{e.classList.remove("pagination__item-active")})),e.blogItems.pageElems.links.forEach((e=>{e.getAttribute("data-pagenumber")!==currentPage||e.parentElement.classList.add("pagination__item-active")}))},setArrows=e=>{const t=e.blogItems.blogPagination.querySelectorAll("svg"),[a,r]=t;1!=+currentPage?a.classList.add("pagination__arrow-active"):a.classList.remove("pagination__arrow-active"),+currentPage>=3?r.classList.remove("pagination__arrow-active"):r.classList.add("pagination__arrow-active")},setArrowLink=e=>{endPage=localStorage.getItem("endPage"),+currentPage>1&&(e.blogItems.pageElems.leftLink.href="blog.html?page="+(+currentPage-1)),+currentPage<+endPage&&(e.blogItems.pageElems.rightLink.href="blog.html?page="+(+currentPage+1))};export const paginationClickHandler=e=>{e.blogItems.pageElems.pageList.addEventListener("click",(t=>{t.preventDefault();const a=t.target;console.log(" : ",currentPage,endPage);const r=a.getAttribute("data-pageNumber");console.log(" : ",r),+r!=+currentPage&&(currentPage=a.getAttribute("data-pageNumber"),setStorage(currentPageStr,currentPage),loadItemsHandler(e),paginationHandler(e))})),(()=>{const t=e.blogItems.pageElems.leftLink,a=e.blogItems.pageElems.rightLink;t.addEventListener("click",(t=>{t.preventDefault();t.target.closest(".pagination__link-left")&&+currentPage>1&&(currentPage=+currentPage-1,setStorage(currentPageStr,currentPage),loadItemsHandler(e),paginationHandler(e))})),a.addEventListener("click",(t=>{t.preventDefault();t.target.closest(".pagination__link-right")&&+currentPage<3&&(currentPage=+currentPage+1,setStorage(currentPageStr,currentPage),loadItemsHandler(e),paginationHandler(e))}))})()};export const paginationHandler=e=>{setPage(e),setArrows(e),setArrowLink(e)};
//# sourceMappingURL=../../../maps/module/blog/handleLoadBlog.js.map
